{"ast":null,"code":"import _objectSpread from\"/Users/xuyanjun/workspace/vision/airdrop_protocol/airdrop_interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _defineProperty from\"/Users/xuyanjun/workspace/vision/airdrop_protocol/airdrop_interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/xuyanjun/workspace/vision/airdrop_protocol/airdrop_interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/xuyanjun/workspace/vision/airdrop_protocol/airdrop_interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/xuyanjun/workspace/vision/airdrop_protocol/airdrop_interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/xuyanjun/workspace/vision/airdrop_protocol/airdrop_interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";var _EMPTY_LIST;import{ChainId,Token}from'@uniswap/sdk';import{useMemo}from'react';import{useSelector}from'react-redux';import{AIRLABEL_TOKEN_LIST_URL,AIR_TOKEN_LIST_URL}from'../../constants/lists';/**\n * Token instances created from token info.\n */export var WrappedTokenInfo=/*#__PURE__*/function(_Token){_inherits(WrappedTokenInfo,_Token);var _super=_createSuper(WrappedTokenInfo);function WrappedTokenInfo(tokenInfo,tags){var _this;_classCallCheck(this,WrappedTokenInfo);_this=_super.call(this,tokenInfo.chainId,tokenInfo.address,tokenInfo.decimals,tokenInfo.symbol,tokenInfo.name);_this.tokenInfo=void 0;_this.tags=void 0;_this.tokenInfo=tokenInfo;_this.tags=tags;return _this;}_createClass(WrappedTokenInfo,[{key:\"logoURI\",get:function get(){return this.tokenInfo.logoURI;}}]);return WrappedTokenInfo;}(Token);/**\n * An empty result, useful as a default.\n */var EMPTY_LIST=(_EMPTY_LIST={},_defineProperty(_EMPTY_LIST,ChainId.SEPOLIA,{}),_defineProperty(_EMPTY_LIST,ChainId.MAINNET,{}),_EMPTY_LIST);var listCache=typeof WeakMap!=='undefined'?new WeakMap():null;export function listToTokenMap(list){var result=listCache===null||listCache===void 0?void 0:listCache.get(list);if(result)return result;var map=list.tokens.reduce(function(tokenMap,tokenInfo){var _tokenInfo$tags$map$f,_tokenInfo$tags,_tokenInfo$tags$map;var tags=(_tokenInfo$tags$map$f=(_tokenInfo$tags=tokenInfo.tags)===null||_tokenInfo$tags===void 0?void 0:(_tokenInfo$tags$map=_tokenInfo$tags.map(function(tagId){var _list$tags;if(!((_list$tags=list.tags)===null||_list$tags===void 0?void 0:_list$tags[tagId]))return undefined;return _objectSpread(_objectSpread({},list.tags[tagId]),{},{id:tagId});}))===null||_tokenInfo$tags$map===void 0?void 0:_tokenInfo$tags$map.filter(function(x){return Boolean(x);}))!==null&&_tokenInfo$tags$map$f!==void 0?_tokenInfo$tags$map$f:[];var token=new WrappedTokenInfo(tokenInfo,tags);if(tokenMap[token.chainId][token.address]!==undefined)throw Error('Duplicate tokens.');return _objectSpread(_objectSpread({},tokenMap),{},_defineProperty({},token.chainId,_objectSpread(_objectSpread({},tokenMap[token.chainId]),{},_defineProperty({},token.address,token))));},_objectSpread({},EMPTY_LIST));// listCache?.set(list, map)\nreturn map;}export function useTokenList(url){var lists=useSelector(function(state){return state.lists.byUrl;});return useMemo(function(){var _lists$url;if(!url)return EMPTY_LIST;var current=(_lists$url=lists[url])===null||_lists$url===void 0?void 0:_lists$url.current;if(!current)return EMPTY_LIST;try{return listToTokenMap(current);}catch(error){console.error('Could not show token list due to error',error);return EMPTY_LIST;}},[lists,url]);}export function useSelectedListUrl(){return useSelector(function(state){return state.lists.selectedListUrl;});}export function useSelectedTokenList(){return useTokenList(useSelectedListUrl());}export function useAirTokenList(){return useTokenList(AIR_TOKEN_LIST_URL);}export function useAirLabelTokenList(){return useTokenList(AIRLABEL_TOKEN_LIST_URL);}export function useSelectedListInfo(){var _list$current,_list$pendingUpdate;var selectedUrl=useSelectedListUrl();var listsByUrl=useSelector(function(state){return state.lists.byUrl;});var list=selectedUrl?listsByUrl[selectedUrl]:undefined;return{current:(_list$current=list===null||list===void 0?void 0:list.current)!==null&&_list$current!==void 0?_list$current:null,pending:(_list$pendingUpdate=list===null||list===void 0?void 0:list.pendingUpdate)!==null&&_list$pendingUpdate!==void 0?_list$pendingUpdate:null,loading:(list===null||list===void 0?void 0:list.loadingRequestId)!==null};}// returns all downloaded current lists\nexport function useAllLists(){var lists=useSelector(function(state){return state.lists.byUrl;});return useMemo(function(){return Object.keys(lists).map(function(url){return lists[url].current;}).filter(function(l){return Boolean(l);});},[lists]);}","map":{"version":3,"sources":["/Users/xuyanjun/workspace/vision/airdrop_protocol/airdrop_interface/src/state/lists/hooks.ts"],"names":["ChainId","Token","useMemo","useSelector","AIRLABEL_TOKEN_LIST_URL","AIR_TOKEN_LIST_URL","WrappedTokenInfo","tokenInfo","tags","chainId","address","decimals","symbol","name","logoURI","EMPTY_LIST","SEPOLIA","MAINNET","listCache","WeakMap","listToTokenMap","list","result","get","map","tokens","reduce","tokenMap","tagId","undefined","id","filter","x","Boolean","token","Error","useTokenList","url","lists","state","byUrl","current","error","console","useSelectedListUrl","selectedListUrl","useSelectedTokenList","useAirTokenList","useAirLabelTokenList","useSelectedListInfo","selectedUrl","listsByUrl","pending","pendingUpdate","loading","loadingRequestId","useAllLists","Object","keys","l"],"mappings":"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","sourcesContent":["import { ChainId, Token } from '@uniswap/sdk'\nimport { Tags, TokenInfo, TokenList } from '@uniswap/token-lists'\nimport { useMemo } from 'react'\nimport { useSelector } from 'react-redux'\nimport { AppState } from '../index'\nimport { AIRLABEL_TOKEN_LIST_URL, AIR_TOKEN_LIST_URL } from '../../constants/lists'\n\ntype TagDetails = Tags[keyof Tags]\nexport interface TagInfo extends TagDetails {\n  id: string\n}\n\n/**\n * Token instances created from token info.\n */\nexport class WrappedTokenInfo extends Token {\n  public readonly tokenInfo: TokenInfo\n  public readonly tags: TagInfo[]\n  constructor(tokenInfo: TokenInfo, tags: TagInfo[]) {\n    super(tokenInfo.chainId, tokenInfo.address, tokenInfo.decimals, tokenInfo.symbol, tokenInfo.name)\n    this.tokenInfo = tokenInfo\n    this.tags = tags\n  }\n  public get logoURI(): string | undefined {\n    return this.tokenInfo.logoURI\n  }\n}\n\nexport type TokenAddressMap = Readonly<{ [chainId in ChainId]: Readonly<{ [tokenAddress: string]: WrappedTokenInfo }> }>\n\n/**\n * An empty result, useful as a default.\n */\nconst EMPTY_LIST: TokenAddressMap = {\n  [ChainId.SEPOLIA]: {},\n  [ChainId.MAINNET]: {}\n}\n\nconst listCache: WeakMap<TokenList, TokenAddressMap> | null =\n  typeof WeakMap !== 'undefined' ? new WeakMap<TokenList, TokenAddressMap>() : null\n\nexport function listToTokenMap(list: TokenList): TokenAddressMap {\n  const result = listCache?.get(list)\n  if (result) return result\n\n  const map = list.tokens.reduce<TokenAddressMap>(\n    (tokenMap, tokenInfo) => {\n      const tags: TagInfo[] =\n        tokenInfo.tags\n          ?.map(tagId => {\n            if (!list.tags?.[tagId]) return undefined\n            return { ...list.tags[tagId], id: tagId }\n          })\n          ?.filter((x): x is TagInfo => Boolean(x)) ?? []\n      const token = new WrappedTokenInfo(tokenInfo, tags)\n      if (tokenMap[token.chainId][token.address] !== undefined) throw Error('Duplicate tokens.')\n      return {\n        ...tokenMap,\n        [token.chainId]: {\n          ...tokenMap[token.chainId],\n          [token.address]: token\n        }\n      }\n    },\n    { ...EMPTY_LIST }\n  )\n  // listCache?.set(list, map)\n  return map\n}\n\nexport function useTokenList(url: string | undefined): TokenAddressMap {\n  const lists = useSelector<AppState, AppState['lists']['byUrl']>(state => state.lists.byUrl)\n\n  return useMemo(() => {\n    if (!url) return EMPTY_LIST\n    const current = lists[url]?.current\n    if (!current) return EMPTY_LIST\n    try {\n      return listToTokenMap(current)\n    } catch (error) {\n      console.error('Could not show token list due to error', error)\n      return EMPTY_LIST\n    }\n  }, [lists, url])\n}\n\nexport function useSelectedListUrl(): string | undefined {\n  return useSelector<AppState, AppState['lists']['selectedListUrl']>(state => state.lists.selectedListUrl)\n}\n\nexport function useSelectedTokenList(): TokenAddressMap {\n  return useTokenList(useSelectedListUrl())\n}\n\nexport function useAirTokenList(): TokenAddressMap {\n  return useTokenList(AIR_TOKEN_LIST_URL)\n}\n\nexport function useAirLabelTokenList(): TokenAddressMap {\n  return useTokenList(AIRLABEL_TOKEN_LIST_URL)\n}\n\nexport function useSelectedListInfo(): { current: TokenList | null; pending: TokenList | null; loading: boolean } {\n  const selectedUrl = useSelectedListUrl()\n  const listsByUrl = useSelector<AppState, AppState['lists']['byUrl']>(state => state.lists.byUrl)\n  const list = selectedUrl ? listsByUrl[selectedUrl] : undefined\n  return {\n    current: list?.current ?? null,\n    pending: list?.pendingUpdate ?? null,\n    loading: list?.loadingRequestId !== null\n  }\n}\n\n// returns all downloaded current lists\nexport function useAllLists(): TokenList[] {\n  const lists = useSelector<AppState, AppState['lists']['byUrl']>(state => state.lists.byUrl)\n\n  return useMemo(\n    () =>\n      Object.keys(lists)\n        .map(url => lists[url].current)\n        .filter((l): l is TokenList => Boolean(l)),\n    [lists]\n  )\n}\n"]},"metadata":{},"sourceType":"module"}